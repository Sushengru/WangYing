数据清洗项目说明
---------------

### 项目背景：
  &emsp;&emsp;
  我刚来到wangying的时候，这边做数据分析前的数据清洗工作前全都是通过excel清洗的。那是正逢双11节后复
盘，数据部门这边也要出一些分析报告，正好目睹了同事用excel清洗了某个母婴品牌2年范围内的数据的过程，
他洗了大约3天的时间。。。后来跟部门主管聊过这件事情后，就自主地去推进这个项目的落地了。最终，就有
了现在项目的情况。<br>


### 项目需求和方案设计：
  &emsp;&emsp;
  项目的初衷是解决公司内部涉及品牌全部的数据清洗工作，并且在后期能够通过跑python的形式进行快速迭代数
据，降低维护成本。

  &emsp;&emsp;
  奔着这个需求目标，就开始想着设计实现方案了。
    
  &emsp;&emsp;
  首先是如何去清洗是数据。这个步骤只能摸着石头过河，一方面从数据表象中区分出一些需要清洗的内容，另一
方面，从清洗后的数据结果里面去查看是否还有遗漏。总结下，淘系数据的清洗主要有几个方面需要去注意：

&emsp;&emsp;&emsp;1. sale字段和order_fee字段的整合。两个都是销售额字段，但后来order_fee字段更准确；<br>
&emsp;&emsp;&emsp;2. 优惠券、N件爆款、超级特价、邮费、赠品等订单数据的清洗和归类；<br>
&emsp;&emsp;&emsp;3. 交易关闭的订单是否保留；<br>
&emsp;&emsp;&emsp;4. 其他异常数据；<br>  

  &emsp;&emsp;
  我最终在当时考虑了结合品牌的产品数据进行整合清理的方式，通过给产品数据打标，匹配订单数据中的title或
`num_iid`（商品页面ID)或`outer_iid`（产品skuID）的形式来清洗。这种做法的好处是，在后续的数据分析的过程
中，可以展开产品维度的分析。 
  
  &emsp;&emsp;
  所以，作死般地，我又得去整合产品表（真的是 No 作 No Die）。整个清洗过程中最耗时、最麻烦的事情就是
这一步了。而且运营那边也没有，只能自己去去重所有的`title`、`outer_iid`、`num_iid`、`date`等字段，然后手动
对商品进行打标。当时某个母婴品牌的产品表清洗是真的累，洗了3000+条产品信息，又打标了罐数、盒罐装等
好几个产品属性，花了好几天，前后还改版了好几次。   
  
  &emsp;&emsp;
  其次，对于清洗后数据的设计方面，考虑到部分品牌的订单数据量已经很庞大了，那么就非常有必要去切分数
据，大体上分成2个类别：属性数据和行为数据。属性数据就是消费者的一些信息，比如`地址`、`手机号`等。
行为数据便是订单的购买相关数据，比如`订单ID`、`支付金额`、`商品标题`等。订单表方面，对于清洗下来的数据
也没有直接丢掉，而是存储在创同维度的非订单表中。  

### 程序设计：

  &emsp;&emsp;
  在明确需求和设计方案之后，就是要开始写python流程了。   
  &emsp;&emsp;
  在早期的这个过程中，每个品牌的清洗是独立写一个清洗流程的，后来清洗品牌多了，且时间空余下来后，就
和同事一起去迭代了一版，将流程代码高度封装。这也是目前还在使用的迭代版本（微调都不算）。   
  &emsp;&emsp;
  程序结构上分几个文件：<br>
&emsp;&emsp;&emsp;`DB_Connect/db_connect.py` : 封装涉及到的数据库连接<br>
&emsp;&emsp;&emsp;`usage_method.py` : 所有品牌都要涉及的操作函数封装,如字段排序、获取当前日期<br>
&emsp;&emsp;&emsp;`usage_sql.py` : 查询订单sql、建表sql的封装，用品牌名作为参数传入以区分<br>
&emsp;&emsp;&emsp;`get_品牌名.py` : 执行文件。（不同品牌的清洗操作多少会有点不同，因此需要分开写）<br>
    
  &emsp;&emsp;
  另外，从性能或便利性或拓展性角度出发，做了几件事情：<br>
&emsp;&emsp;&emsp;a. 获取当前日期和清洗表的日期来判断来查询增量，而非全部数据；<br>
&emsp;&emsp;&emsp;b. 增加数据统计表的生成，便于常规统计数据的使用和简化sql；<br>
&emsp;&emsp;&emsp;c. 按步骤封装函数，以及按参数-执行的流程编写，提升代码简洁性；<br>
&emsp;&emsp;&emsp;d. 丰富的注释；<br>
